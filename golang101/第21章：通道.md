# 通道类型和值

通道可以是双向的，也可以是单向的。
- 字面形式chan T表示一个元素类型为T的双向通道类型。 编译器允许从此类型的值中接收和向此类型的值中发送数据。
- 字面形式chan<- T表示一个元素类型为T的单向发送通道类型。 编译器不允许从此类型的值中接收数据。
- 字面形式<-chan T表示一个元素类型为T的单向接收通道类型。 编译器不允许向此类型的值中发送数据。

双向通道chan T的值可以被隐式转换为单向通道类型chan<- T和<-chan T，但反之不行（即使显式也不行）。 类型chan<- T和<-chan T的值也不能相互转换。

每个通道值有一个容量属性。此属性的意义将在下一节中得到解释。 一个容量为0的通道值称为一个非缓冲通道（unbuffered channel），一个容量不为0的通道值称为一个缓冲通道（buffered channel）。

# 通道值的比较

所有通道类型均为可比较类型。
我们了解到一个通道值可能含有底层部分。 当一个通道值被赋给另一个通道值后，这两个通道值将共享相同的底层部分。 换句话说，这两个通道引用着同一个底层的内部通道对象。 比较这两个通道的结果为true。

# 通道操作

 1. 调用内置函数close来关闭一个通道：
 ``close(ch)``
 传给close函数调用的实参必须为一个通道值，并且此通道值不能为单向接收的。

 2. 使用下面的语法向通道ch发送一个值v：
``ch <- v``
v必须能够赋值给通道ch的元素类型。 ch不能为单向接收通道。 <-称为数据发送操作符。

3.  使用下面的语法从通道ch接收一个值：
``<-ch``
如果一个通道操作不永久阻塞，它总会返回至少一个值，此值的类型为通道ch的元素类型。 ch不能为单向发送通道。 <-称为数据接收操作符，是的它和数据发送操作符的表示形式是一样的。
在大多数场合下，一个数据接收操作可以被认为是一个单值表达式。 但是，当一个数据接收操作被用做一个赋值语句中的唯一的源值的时候，它可以返回第二个可选的类型不确定的布尔值返回值从而成为一个多值表达式。 此类型不确定的布尔值表示第一个接收到的值是否是在通道被关闭前发送的。 （从后面的章节，我们将得知我们可以从一个已关闭的通道中接收到无穷个值。
数据接收操作在赋值中被用做源值的例子：
```
    v = <-ch
    v, sentBeforeClosed = <-ch
```

4. 查询一个通道的容量：
``cap(ch)``
其中cap是一个已经在容器类型（第18章）一文中介绍过的内置函数。 cap的返回值的类型为内置类型int。

5. 查询一个通道的长度：
``len(ch)``

# 通道操作详解

为了让解释简单清楚，在本文后续部分，通道将被归为三类：
1. 零值（nil）通道；
2. 非零值但已关闭的通道；
3. 非零值并且尚未关闭的通道。

下表简单地描述了三种通道操作施加到三类通道的结果。
![](images/21-1.png)

对于上表中的五种未打上标的情形，规则很简单：
- 关闭一个nil通道或者一个已经关闭的通道将产生一个恐慌
- 向一个已关闭的通道发送数据也将导致一个恐慌。
- 向一个nil通道发送数据或者从一个nil通道接收数据将使当前协程永久阻塞。